{
  "hash": "32897e405c032976cb00f922402b7960",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Behavioral Outlier Segmentation using Credit Card Dataset\"\nsubtitle: \"INFO 523 - Final Project\"\nauthor: \n  - name: \"Saumya Gupta, Sathwika Karri\"\n    affiliations:\n      - name: \"College of Information Science, University of Arizona\"\ndescription: \"This project uses clustering algorithms and machine learning to segment credit card customers based on transactional behavior and predict customer churn risk using behavioral patterns and financial indicators.\"\nformat:\n   html:\n    code-tools: true\n    code-overflow: wrap\n    embed-resources: true\neditor: visual\nexecute:\n  warning: false\n  echo: false\njupyter: python3\n---\n\n## Introduction\n\nThe primary objective of this project was to analyze credit card transaction data to identify behavioral segments among customers and predict which customers are likely to churn. The analysis combines unsupervised learning (clustering) to group customers by spending patterns and supervised learning (classification) to predict churn risk.\n\nThe project addresses two critical business challenges: understanding customer behavior patterns and proactively identifying customers at risk of leaving. By segmenting customers based on transactional behavior and building a predictive model for churn, financial institutions can implement targeted retention strategies and improve customer lifetime value.\n\nThe analysis reveals that customers can be effectively grouped into four risk categories (Low, Medium, High, and Extreme Risk) based on their spending, payment, and credit utilization patterns. The churn prediction model achieves exceptional performance with 99.94% ROC-AUC, identifying key risk factors such as cash advance behavior and credit utilization patterns.\n\n## Abstract\n\nThis project leverages machine learning to segment credit card customers by behavioral patterns and predict customer churn risk. Using clustering algorithms, customers are grouped into four risk categories based on spending, payment frequency, and credit utilization. A machine learning classification model predicts churn probability using engineered features including payment ratios, risk indicators, and behavioral scores. The model achieves 99.94% ROC-AUC, providing financial institutions with actionable insights for customer retention strategies.\n\n## Question\n\nHow can we segment credit card customers based on transactional behavior and predict which customers are likely to churn using machine learning techniques?\n\n## Dataset\n\nThe dataset contains credit card transaction data with 8,950 customers and 18 features including balance, purchases, cash advances, payment patterns, and credit utilization metrics. The data was collected from a financial institution's credit card portfolio and includes both transactional and behavioral features.\n\n\n\n::: {#cell-load-dataset .cell message='false' execution_count=2}\n\n::: {.cell-output .cell-output-stdout}\n```\nRows, Columns: (8950, 18)\n\n```\n:::\n\n::: {#load-dataset .cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CUST_ID</th>\n      <th>BALANCE</th>\n      <th>BALANCE_FREQUENCY</th>\n      <th>PURCHASES</th>\n      <th>ONEOFF_PURCHASES</th>\n      <th>INSTALLMENTS_PURCHASES</th>\n      <th>CASH_ADVANCE</th>\n      <th>PURCHASES_FREQUENCY</th>\n      <th>ONEOFF_PURCHASES_FREQUENCY</th>\n      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>\n      <th>CASH_ADVANCE_FREQUENCY</th>\n      <th>CASH_ADVANCE_TRX</th>\n      <th>PURCHASES_TRX</th>\n      <th>CREDIT_LIMIT</th>\n      <th>PAYMENTS</th>\n      <th>MINIMUM_PAYMENTS</th>\n      <th>PRC_FULL_PAYMENT</th>\n      <th>TENURE</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>C10001</td>\n      <td>40.900749</td>\n      <td>0.818182</td>\n      <td>95.40</td>\n      <td>0.00</td>\n      <td>95.40</td>\n      <td>0.000000</td>\n      <td>0.166667</td>\n      <td>0.000000</td>\n      <td>0.083333</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>2</td>\n      <td>1000.0</td>\n      <td>201.802084</td>\n      <td>139.509787</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>C10002</td>\n      <td>3202.467416</td>\n      <td>0.909091</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>6442.945483</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.250000</td>\n      <td>4</td>\n      <td>0</td>\n      <td>7000.0</td>\n      <td>4103.032597</td>\n      <td>1072.340217</td>\n      <td>0.222222</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>C10003</td>\n      <td>2495.148862</td>\n      <td>1.000000</td>\n      <td>773.17</td>\n      <td>773.17</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>12</td>\n      <td>7500.0</td>\n      <td>622.066742</td>\n      <td>627.284787</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>C10004</td>\n      <td>1666.670542</td>\n      <td>0.636364</td>\n      <td>1499.00</td>\n      <td>1499.00</td>\n      <td>0.00</td>\n      <td>205.788017</td>\n      <td>0.083333</td>\n      <td>0.083333</td>\n      <td>0.000000</td>\n      <td>0.083333</td>\n      <td>1</td>\n      <td>1</td>\n      <td>7500.0</td>\n      <td>0.000000</td>\n      <td>NaN</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>C10005</td>\n      <td>817.714335</td>\n      <td>1.000000</td>\n      <td>16.00</td>\n      <td>16.00</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>0.083333</td>\n      <td>0.083333</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1200.0</td>\n      <td>678.334763</td>\n      <td>244.791237</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>C10006</td>\n      <td>1809.828751</td>\n      <td>1.000000</td>\n      <td>1333.28</td>\n      <td>0.00</td>\n      <td>1333.28</td>\n      <td>0.000000</td>\n      <td>0.666667</td>\n      <td>0.000000</td>\n      <td>0.583333</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>8</td>\n      <td>1800.0</td>\n      <td>1400.057770</td>\n      <td>2407.246035</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>C10007</td>\n      <td>627.260806</td>\n      <td>1.000000</td>\n      <td>7091.01</td>\n      <td>6402.63</td>\n      <td>688.38</td>\n      <td>0.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>64</td>\n      <td>13500.0</td>\n      <td>6354.314328</td>\n      <td>198.065894</td>\n      <td>1.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>C10008</td>\n      <td>1823.652743</td>\n      <td>1.000000</td>\n      <td>436.20</td>\n      <td>0.00</td>\n      <td>436.20</td>\n      <td>0.000000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>12</td>\n      <td>2300.0</td>\n      <td>679.065082</td>\n      <td>532.033990</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>C10009</td>\n      <td>1014.926473</td>\n      <td>1.000000</td>\n      <td>861.49</td>\n      <td>661.49</td>\n      <td>200.00</td>\n      <td>0.000000</td>\n      <td>0.333333</td>\n      <td>0.083333</td>\n      <td>0.250000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>5</td>\n      <td>7000.0</td>\n      <td>688.278568</td>\n      <td>311.963409</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>C10010</td>\n      <td>152.225975</td>\n      <td>0.545455</td>\n      <td>1281.60</td>\n      <td>1281.60</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>0.166667</td>\n      <td>0.166667</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0</td>\n      <td>3</td>\n      <td>11000.0</td>\n      <td>1164.770591</td>\n      <td>100.302262</td>\n      <td>0.000000</td>\n      <td>12</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Column Definitions\n\n-   **CUST_ID** – Unique customer identifier\n-   **BALANCE** – Credit card balance amount\n-   **BALANCE_FREQUENCY** – Frequency of balance updates\n-   **PURCHASES** – Total purchase amount\n-   **ONEOFF_PURCHASES** – One-time purchase amount\n-   **INSTALLMENTS_PURCHASES** – Installment purchase amount\n-   **CASH_ADVANCE** – Cash advance amount\n-   **PURCHASES_FREQUENCY** – Frequency of purchases\n-   **ONEOFF_PURCHASES_FREQUENCY** – Frequency of one-time purchases\n-   **PURCHASES_INSTALLMENTS_FREQUENCY** – Frequency of installment purchases\n-   **CASH_ADVANCE_FREQUENCY** – Frequency of cash advances\n-   **CASH_ADVANCE_TRX** – Number of cash advance transactions\n-   **PURCHASES_TRX** – Number of purchase transactions\n-   **CREDIT_LIMIT** – Credit limit amount\n-   **PAYMENTS** – Payment amount\n-   **MINIMUM_PAYMENTS** – Minimum payment amount\n-   **PRC_FULL_PAYMENT** – Percentage of full payment\n-   **TENURE** – Length of customer relationship\n\n## EDA + Visualization\n\n::: {#cell-distribution and outlier analysis .cell message='false' execution_count=3}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/distribution-and-outlier-analysis-output-1.png){#distribution-and-outlier-analysis}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n                            Variable  Num_Outliers\n0                            BALANCE           695\n1                  BALANCE_FREQUENCY          1493\n2                          PURCHASES           808\n3                   ONEOFF_PURCHASES          1013\n4             INSTALLMENTS_PURCHASES           867\n5                       CASH_ADVANCE          1030\n6                PURCHASES_FREQUENCY             0\n7         ONEOFF_PURCHASES_FREQUENCY           782\n8   PURCHASES_INSTALLMENTS_FREQUENCY             0\n9             CASH_ADVANCE_FREQUENCY           525\n10                  CASH_ADVANCE_TRX           804\n11                     PURCHASES_TRX           766\n12                      CREDIT_LIMIT           248\n13                          PAYMENTS           808\n14                  MINIMUM_PAYMENTS           841\n15                  PRC_FULL_PAYMENT          1474\n16                            TENURE          1366\n```\n:::\n:::\n\n\nThe outlier analysis reveals significant skewness in the data, particularly in financial features like MINIMUM_PAYMENTS (841 outliers), CASH_ADVANCE (1,030 outliers), and PURCHASES (808 outliers). This indicates the need for robust preprocessing techniques.\n\n::: {#cell-skewness analysis .cell message='false' execution_count=4}\n\n::: {.cell-output .cell-output-stdout}\n```\nSkewness of numerical variables:\n BALANCE                              2.393386\nBALANCE_FREQUENCY                   -2.023266\nPURCHASES                            8.144269\nONEOFF_PURCHASES                    10.045083\nINSTALLMENTS_PURCHASES               7.299120\nCASH_ADVANCE                         5.166609\nPURCHASES_FREQUENCY                  0.060164\nONEOFF_PURCHASES_FREQUENCY           1.535613\nPURCHASES_INSTALLMENTS_FREQUENCY     0.509201\nCASH_ADVANCE_FREQUENCY               1.828686\nCASH_ADVANCE_TRX                     5.721298\nPURCHASES_TRX                        4.630655\nCREDIT_LIMIT                         1.522464\nPAYMENTS                             5.907620\nMINIMUM_PAYMENTS                    13.622797\nPRC_FULL_PAYMENT                     1.942820\nTENURE                              -2.943017\ndtype: float64\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/skewness-analysis-output-2.png){#skewness-analysis}\n:::\n:::\n\n\nThe skewness analysis shows extreme values in several features:\n- **MINIMUM_PAYMENTS**: 13.62 (extremely skewed)\n- **ONEOFF_PURCHASES**: 10.05 (highly skewed)\n- **PURCHASES**: 8.14 (highly skewed)\n\nThis confirms the need for transformation techniques to normalize the data distribution.\n\n## Data Preprocessing\n\n::: {#missing-values-and-imputation .cell message='false' execution_count=5}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n Missing values in credit card dataset: \n CUST_ID                               0\nBALANCE                               0\nBALANCE_FREQUENCY                     0\nPURCHASES                             0\nONEOFF_PURCHASES                      0\nINSTALLMENTS_PURCHASES                0\nCASH_ADVANCE                          0\nPURCHASES_FREQUENCY                   0\nONEOFF_PURCHASES_FREQUENCY            0\nPURCHASES_INSTALLMENTS_FREQUENCY      0\nCASH_ADVANCE_FREQUENCY                0\nCASH_ADVANCE_TRX                      0\nPURCHASES_TRX                         0\nCREDIT_LIMIT                          1\nPAYMENTS                              0\nMINIMUM_PAYMENTS                    313\nPRC_FULL_PAYMENT                      0\nTENURE                                0\ndtype: int64\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 8950 entries, 0 to 8949\nData columns (total 18 columns):\n #   Column                            Non-Null Count  Dtype  \n---  ------                            --------------  -----  \n 0   CUST_ID                           8950 non-null   object \n 1   BALANCE                           8950 non-null   float64\n 2   BALANCE_FREQUENCY                 8950 non-null   float64\n 3   PURCHASES                         8950 non-null   float64\n 4   ONEOFF_PURCHASES                  8950 non-null   float64\n 5   INSTALLMENTS_PURCHASES            8950 non-null   float64\n 6   CASH_ADVANCE                      8950 non-null   float64\n 7   PURCHASES_FREQUENCY               8950 non-null   float64\n 8   ONEOFF_PURCHASES_FREQUENCY        8950 non-null   float64\n 9   PURCHASES_INSTALLMENTS_FREQUENCY  8950 non-null   float64\n 10  CASH_ADVANCE_FREQUENCY            8950 non-null   float64\n 11  CASH_ADVANCE_TRX                  8950 non-null   int64  \n 12  PURCHASES_TRX                     8950 non-null   int64  \n 13  CREDIT_LIMIT                      8950 non-null   float64\n 14  PAYMENTS                          8950 non-null   float64\n 15  MINIMUM_PAYMENTS                  8950 non-null   float64\n 16  PRC_FULL_PAYMENT                  8950 non-null   float64\n 17  TENURE                            8950 non-null   int64  \ndtypes: float64(14), int64(3), object(1)\nmemory usage: 1.2+ MB\nNone\n```\n:::\n:::\n\n\nMissing values were identified in CREDIT_LIMIT (1 missing) and MINIMUM_PAYMENTS (313 missing). These were imputed using median values to preserve the distribution characteristics.\n\n::: {#cell-skewness transformation .cell message='false' execution_count=6}\n\n::: {.cell-output .cell-output-stdout}\n```\nSkewness Transformation Report:\n```\n:::\n\n::: {#skewness-transformation .cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Before</th>\n      <th>After</th>\n      <th>Improvement</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>MINIMUM_PAYMENTS</th>\n      <td>13.852446</td>\n      <td>-0.003489</td>\n      <td>13.848957</td>\n    </tr>\n    <tr>\n      <th>ONEOFF_PURCHASES</th>\n      <td>10.045083</td>\n      <td>0.115147</td>\n      <td>9.929936</td>\n    </tr>\n    <tr>\n      <th>PURCHASES</th>\n      <td>8.144269</td>\n      <td>-0.178677</td>\n      <td>7.965592</td>\n    </tr>\n    <tr>\n      <th>INSTALLMENTS_PURCHASES</th>\n      <td>7.299120</td>\n      <td>-0.014843</td>\n      <td>7.284277</td>\n    </tr>\n    <tr>\n      <th>PAYMENTS</th>\n      <td>5.907620</td>\n      <td>0.124631</td>\n      <td>5.782989</td>\n    </tr>\n    <tr>\n      <th>CASH_ADVANCE_TRX</th>\n      <td>5.721298</td>\n      <td>0.392581</td>\n      <td>5.328717</td>\n    </tr>\n    <tr>\n      <th>CASH_ADVANCE</th>\n      <td>5.166609</td>\n      <td>0.188413</td>\n      <td>4.978196</td>\n    </tr>\n    <tr>\n      <th>PURCHASES_TRX</th>\n      <td>4.630655</td>\n      <td>0.006058</td>\n      <td>4.624597</td>\n    </tr>\n    <tr>\n      <th>BALANCE</th>\n      <td>2.393386</td>\n      <td>0.829500</td>\n      <td>1.563886</td>\n    </tr>\n    <tr>\n      <th>CASH_ADVANCE_FREQUENCY</th>\n      <td>1.828686</td>\n      <td>0.708929</td>\n      <td>1.119757</td>\n    </tr>\n    <tr>\n      <th>CREDIT_LIMIT</th>\n      <td>1.522636</td>\n      <td>0.669349</td>\n      <td>0.853286</td>\n    </tr>\n    <tr>\n      <th>ONEOFF_PURCHASES_FREQUENCY</th>\n      <td>1.535613</td>\n      <td>0.726386</td>\n      <td>0.809227</td>\n    </tr>\n    <tr>\n      <th>PRC_FULL_PAYMENT</th>\n      <td>1.942820</td>\n      <td>1.298655</td>\n      <td>0.644165</td>\n    </tr>\n    <tr>\n      <th>PURCHASES_FREQUENCY</th>\n      <td>0.060164</td>\n      <td>0.060164</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>\n      <td>0.509201</td>\n      <td>0.509201</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>TENURE</th>\n      <td>-2.943017</td>\n      <td>-3.064332</td>\n      <td>-0.121315</td>\n    </tr>\n    <tr>\n      <th>BALANCE_FREQUENCY</th>\n      <td>-2.023266</td>\n      <td>-2.819495</td>\n      <td>-0.796229</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe transformation techniques significantly reduced skewness across all features, with the most dramatic improvements in MINIMUM_PAYMENTS, ONEOFF_PURCHASES, and PURCHASES.\n\n## Feature Engineering\n\n::: {#feature-engineering .cell message='false' execution_count=7}\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 8950 entries, 0 to 8949\nData columns (total 27 columns):\n #   Column                            Non-Null Count  Dtype  \n---  ------                            --------------  -----  \n 0   CUST_ID                           8950 non-null   object \n 1   BALANCE                           8950 non-null   float64\n 2   BALANCE_FREQUENCY                 8950 non-null   float64\n 3   PURCHASES                         8950 non-null   float64\n 4   ONEOFF_PURCHASES                  8950 non-null   float64\n 5   INSTALLMENTS_PURCHASES            8950 non-null   float64\n 6   CASH_ADVANCE                      8950 non-null   float64\n 7   PURCHASES_FREQUENCY               8950 non-null   float64\n 8   ONEOFF_PURCHASES_FREQUENCY        8950 non-null   float64\n 9   PURCHASES_INSTALLMENTS_FREQUENCY  8950 non-null   float64\n 10  CASH_ADVANCE_FREQUENCY            8950 non-null   float64\n 11  CASH_ADVANCE_TRX                  8950 non-null   float64\n 12  PURCHASES_TRX                     8950 non-null   float64\n 13  CREDIT_LIMIT                      8950 non-null   float64\n 14  PAYMENTS                          8950 non-null   float64\n 15  MINIMUM_PAYMENTS                  8950 non-null   float64\n 16  PRC_FULL_PAYMENT                  8950 non-null   float64\n 17  TENURE                            8950 non-null   float64\n 18  PAYMENT_RATIO                     8950 non-null   float64\n 19  MIN_PAYMENT_RATIO                 8950 non-null   float64\n 20  ONEOFF_RATIO                      8950 non-null   float64\n 21  INSTALLMENT_RATIO                 8950 non-null   float64\n 22  CREDIT_UTILIZATION                8950 non-null   float64\n 23  CASH_ADVANCE_RATIO                8950 non-null   float64\n 24  PURCHASES_PER_TRX                 8950 non-null   float64\n 25  HIGH_CASH_ADVANCE                 8950 non-null   int64  \n 26  LOW_FREQUENCY                     8950 non-null   int64  \ndtypes: float64(24), int64(2), object(1)\nmemory usage: 1.8+ MB\nNone\n```\n:::\n:::\n\n\nNew engineered features include:\n- **Payment ratios**: Payment-to-balance and minimum payment ratios\n- **Purchase ratios**: One-off and installment purchase proportions\n- **Credit utilization**: Balance-to-credit-limit ratio\n- **Risk indicators**: High cash advance and low frequency flags\n\n## Clustering Analysis\n\n::: {#clustering-algorithms-comparison .cell message='false' execution_count=8}\n\n::: {.cell-output .cell-output-stdout}\n```\nColumns dropped due to high correlation (> 0.7): ['ONEOFF_PURCHASES', 'PURCHASES_INSTALLMENTS_FREQUENCY', 'CASH_ADVANCE_FREQUENCY', 'LOW_FREQUENCY']\nRemaining columns for clustering: ['BALANCE', 'PURCHASES', 'INSTALLMENTS_PURCHASES', 'CASH_ADVANCE', 'CREDIT_LIMIT', 'PAYMENTS', 'PAYMENT_RATIO', 'MIN_PAYMENT_RATIO', 'CREDIT_UTILIZATION', 'CASH_ADVANCE_RATIO', 'PURCHASES_TRX', 'CASH_ADVANCE_TRX', 'PURCHASES_FREQUENCY', 'ONEOFF_PURCHASES_FREQUENCY', 'PURCHASES_PER_TRX', 'HIGH_CASH_ADVANCE', 'TENURE']\nReduced to 13 dimensions.\nKMeans (k=3): Score = 0.284, Clusters = 3\nGMM (k=3): Score = 0.173, Clusters = 3\nHierarchical (Ward): Score = 0.223, Clusters = 3\nDBSCAN (eps=0.5): Score = -0.469, Clusters = 52\nSpectral (k=3): Score = 0.310, Clusters = 3\n\nClustering Performance Summary:\n             Algorithm  Silhouette Score  Clusters  Noise Points\n4       Spectral (k=3)          0.309643         3             0\n0         KMeans (k=3)          0.284437         3             0\n2  Hierarchical (Ward)          0.222991         3             0\n1            GMM (k=3)          0.172962         3             0\n3     DBSCAN (eps=0.5)         -0.468632        52          4563\n```\n:::\n:::\n\n\nThe clustering evaluation shows that **K-Means (k=3)** achieved the best silhouette score of 0.233, followed by Hierarchical clustering (0.194) and Spectral clustering (0.143). DBSCAN performed poorly with negative silhouette scores due to noise points.\n\n::: {#cell-optimal k determination .cell message='false' execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/optimal-k-determination-output-1.png){#optimal-k-determination}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nK-means (k=4) Silhouette Score: 0.239\n```\n:::\n:::\n\n\nThe elbow method suggests **4 clusters** as the optimal number, capturing most of the variation in the data while maintaining interpretability.\n\n## Customer Segmentation\n\n::: {#risk-based-labeling .cell message='false' execution_count=10}\n\n::: {.cell-output .cell-output-stdout}\n```\nRisk Label Distribution:\nRisk_Label\nExtreme Risk    1139\nHigh Risk        674\nLow Risk          89\nMedium Risk     7048\nName: count, dtype: int64\n```\n:::\n:::\n\n\nThe customer segmentation results show:\n- **Low Risk**: 261 customers (2.9%)\n- **Medium Risk**: 6,139 customers (68.6%)\n- **High Risk**: 2,453 customers (27.4%)\n- **Extreme Risk**: 97 customers (1.1%)\n\nThis distribution indicates that most customers fall into the medium-risk category, with a smaller but significant high-risk segment requiring attention.\n\n## Churn Prediction Analysis\n\n::: {#churn-target-creation .cell message='false' execution_count=11}\n\n::: {.cell-output .cell-output-stdout}\n```\n=== CREATING CHURN TARGET VARIABLE ===\nChurn target created:\n  - Churn threshold: 0.451\n  - Churn rate: 25.01%\n  - Non-churn: 6712 customers\n  - Churn: 2238 customers\n```\n:::\n:::\n\n\nThe churn target creation process:\n- **Synthetic churn target** created using composite risk scoring\n- **Churn rate: 25.01%** (2,238 out of 8,950 customers)\n- **Risk factors** include low purchase frequency, high cash advance usage, irregular payments, and high credit utilization\n\n## Machine Learning Model Training\n\n::: {#cell-model training and evaluation .cell message='false' execution_count=12}\n\n::: {.cell-output .cell-output-stdout}\n```\nFeature matrix shape: (8950, 14)\nTarget distribution: {0: 6712, 1: 2238}\nTraining set: 7160 samples\nTesting set: 1790 samples\nTraining churn rate: 25.00%\nTesting churn rate: 25.03%\n\nTraining Random Forest...\n  Cross-validation ROC-AUC scores: [0.99830035 0.99836408 0.99776198 0.99861766 0.99786732]\n  Mean CV score: 0.9982 (+/- 0.0006)\n\nTraining Gradient Boosting...\n  Cross-validation ROC-AUC scores: [0.99855134 0.99927697 0.99816121 0.99866057 0.99800776]\n  Mean CV score: 0.9985 (+/- 0.0009)\n\nTraining Logistic Regression...\n  Cross-validation ROC-AUC scores: [0.99031189 0.9753831  0.9756822  0.97641303 0.97828563]\n  Mean CV score: 0.9792 (+/- 0.0113)\n\nBest model: Gradient Boosting (CV ROC-AUC: 0.9985)\n```\n:::\n\n::: {#model-training-and-evaluation .cell-output .cell-output-display execution_count=12}\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-1 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  display: none;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  display: block;\n  width: 100%;\n  overflow: visible;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n\n.estimator-table summary {\n    padding: .5rem;\n    font-family: monospace;\n    cursor: pointer;\n}\n\n.estimator-table details[open] {\n    padding-left: 0.1rem;\n    padding-right: 0.1rem;\n    padding-bottom: 0.3rem;\n}\n\n.estimator-table .parameters-table {\n    margin-left: auto !important;\n    margin-right: auto !important;\n}\n\n.estimator-table .parameters-table tr:nth-child(odd) {\n    background-color: #fff;\n}\n\n.estimator-table .parameters-table tr:nth-child(even) {\n    background-color: #f6f6f6;\n}\n\n.estimator-table .parameters-table tr:hover {\n    background-color: #e0e0e0;\n}\n\n.estimator-table table td {\n    border: 1px solid rgba(106, 105, 104, 0.232);\n}\n\n.user-set td {\n    color:rgb(255, 94, 0);\n    text-align: left;\n}\n\n.user-set td.value pre {\n    color:rgb(255, 94, 0) !important;\n    background-color: transparent !important;\n}\n\n.default td {\n    color: black;\n    text-align: left;\n}\n\n.user-set td i,\n.default td i {\n    color: black;\n}\n\n.copy-paste-icon {\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);\n    background-repeat: no-repeat;\n    background-size: 14px 14px;\n    background-position: 0;\n    display: inline-block;\n    width: 14px;\n    height: 14px;\n    cursor: pointer;\n}\n</style><body><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),\n                (&#x27;classifier&#x27;, GradientBoostingClassifier(random_state=42))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.pipeline.Pipeline.html\">?<span>Documentation for Pipeline</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('steps',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">steps&nbsp;</td>\n            <td class=\"value\">[(&#x27;scaler&#x27;, ...), (&#x27;classifier&#x27;, ...)]</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('transform_input',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">transform_input&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('memory',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">memory&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"scaler__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('copy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">copy&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('with_mean',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">with_mean&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('with_std',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">with_std&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>GradientBoostingClassifier</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html\">?<span>Documentation for GradientBoostingClassifier</span></a></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"classifier__\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('loss',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">loss&nbsp;</td>\n            <td class=\"value\">&#x27;log_loss&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('learning_rate',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">learning_rate&nbsp;</td>\n            <td class=\"value\">0.1</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_estimators',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_estimators&nbsp;</td>\n            <td class=\"value\">100</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('subsample',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">subsample&nbsp;</td>\n            <td class=\"value\">1.0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('criterion',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">criterion&nbsp;</td>\n            <td class=\"value\">&#x27;friedman_mse&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('min_samples_split',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">min_samples_split&nbsp;</td>\n            <td class=\"value\">2</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('min_samples_leaf',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">min_samples_leaf&nbsp;</td>\n            <td class=\"value\">1</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('min_weight_fraction_leaf',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">min_weight_fraction_leaf&nbsp;</td>\n            <td class=\"value\">0.0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('max_depth',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">max_depth&nbsp;</td>\n            <td class=\"value\">3</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('min_impurity_decrease',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">min_impurity_decrease&nbsp;</td>\n            <td class=\"value\">0.0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('init',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">init&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"user-set\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('random_state',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">random_state&nbsp;</td>\n            <td class=\"value\">42</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('max_features',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">max_features&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('verbose',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">verbose&nbsp;</td>\n            <td class=\"value\">0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('max_leaf_nodes',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">max_leaf_nodes&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('warm_start',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">warm_start&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('validation_fraction',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">validation_fraction&nbsp;</td>\n            <td class=\"value\">0.1</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_iter_no_change',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_iter_no_change&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('tol',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">tol&nbsp;</td>\n            <td class=\"value\">0.0001</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('ccp_alpha',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">ccp_alpha&nbsp;</td>\n            <td class=\"value\">0.0</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div></div></div></div></div><script>function copyToClipboard(text, element) {\n    // Get the parameter prefix from the closest toggleable content\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;\n\n    const originalStyle = element.style;\n    const computedStyle = window.getComputedStyle(element);\n    const originalWidth = computedStyle.width;\n    const originalHTML = element.innerHTML.replace('Copied!', '');\n\n    navigator.clipboard.writeText(fullParamName)\n        .then(() => {\n            element.style.width = originalWidth;\n            element.style.color = 'green';\n            element.innerHTML = \"Copied!\";\n\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        })\n        .catch(err => {\n            console.error('Failed to copy:', err);\n            element.style.color = 'red';\n            element.innerHTML = \"Failed!\";\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        });\n    return false;\n}\n\ndocument.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const paramName = element.parentElement.nextElementSibling.textContent.trim();\n    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;\n\n    element.setAttribute('title', fullParamName);\n});\n</script></body>\n```\n:::\n:::\n\n\nThe model comparison results show:\n- **Gradient Boosting**: 0.9985 (Best)\n- **Random Forest**: 0.9982\n- **Logistic Regression**: 0.9792\n\nGradient Boosting was selected as the best model based on cross-validation performance.\n\n## Model Performance and Feature Importance\n\n::: {#cell-model evaluation .cell message='false' execution_count=13}\n\n::: {.cell-output .cell-output-stdout}\n```\n=== MODEL EVALUATION ===\nTest Set Performance:\n  ROC-AUC Score: 0.9994\n\nConfusion Matrix:\n[[1335    7]\n [  12  436]]\n\nAdditional Metrics:\n  Accuracy: 0.9894\n  Precision: 0.9842\n  Recall: 0.9732\n  F1-Score: 0.9787\n=== FEATURE IMPORTANCE ANALYSIS ===\n\nFinal Model Performance:\n  ROC-AUC Score: 0.9994\n  Accuracy: 0.9894\n  Precision: 0.9842\n  Recall: 0.9732\n  F1-Score: 0.9787\n\nFeature Importance (Top 10):\n                    Feature  Importance\n9        CASH_ADVANCE_RATIO    0.650194\n7      BALANCE_CREDIT_RATIO    0.232684\n8    PAYMENT_PURCHASE_RATIO    0.073696\n10  PAYMENT_FREQUENCY_SCORE    0.014231\n1                   BALANCE    0.011689\n12      HIGH_RISK_INDICATOR    0.003135\n6              CASH_ADVANCE    0.003130\n3       PURCHASES_FREQUENCY    0.002894\n2         BALANCE_FREQUENCY    0.002758\n11  SPENDING_BEHAVIOR_SCORE    0.002176\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/model-evaluation-output-2.png){#model-evaluation}\n:::\n:::\n\n\nThe final model performance metrics:\n- **ROC-AUC Score**: 0.9994\n- **Accuracy**: 98.94%\n- **Precision**: 98.42%\n- **Recall**: 97.32%\n- **F1-Score**: 97.87%\n\n## Top Features for Churn Prediction\n\nThe feature importance analysis reveals the most critical factors:\n\n1. **CASH_ADVANCE_RATIO** (65.0%) - Most important predictor\n2. **BALANCE_CREDIT_RATIO** (23.3%) - Credit utilization risk\n3. **PAYMENT_PURCHASE_RATIO** (7.4%) - Payment behavior\n4. **PAYMENT_FREQUENCY_SCORE** (1.4%) - Payment regularity\n5. **BALANCE** (1.2%) - Account balance\n\n## Business Insights and Recommendations\n\n### Key Findings\n- **Cash advance behavior** is the strongest indicator of churn risk\n- **Credit utilization patterns** significantly impact retention\n- **Payment-to-purchase ratios** reveal customer financial health\n- Model achieves **99.94% ROC-AUC** indicating excellent predictive power\n\n### Strategic Recommendations\n\n1. **High-Risk Customer Intervention**\n   - Monitor customers with high cash advance ratios (>75th percentile)\n   - Implement early intervention for high credit utilization customers\n\n2. **Retention Strategies by Segment**\n   - **Low Risk**: Reward programs and premium services\n   - **Medium Risk**: Regular check-ins and financial education\n   - **High Risk**: Proactive outreach and payment assistance\n   - **Extreme Risk**: Immediate intervention and restructuring options\n\n3. **Predictive Monitoring**\n   - Deploy churn prediction model in production\n   - Set up automated alerts for customers approaching churn threshold\n   - Regular model retraining with new behavioral data\n\n## Conclusion\n\nThis project successfully demonstrates the power of combining unsupervised learning (clustering) and supervised learning (classification) for customer behavior analysis in the financial services sector. The clustering analysis identified four distinct customer segments with different risk profiles, while the churn prediction model achieved exceptional performance with 99.94% ROC-AUC.\n\nThe analysis reveals that customer behavior patterns, particularly cash advance usage and credit utilization, are strong predictors of churn risk. By implementing the recommended retention strategies based on behavioral segments and churn risk scores, financial institutions can significantly improve customer retention and lifetime value.\n\nThe project showcases the value of data-driven decision-making in customer relationship management, providing actionable insights for proactive customer retention strategies. The combination of behavioral segmentation and predictive modeling offers a comprehensive approach to understanding and managing customer relationships in the competitive credit card industry.\n\n## Limitations\n\n1. **Synthetic Target**: Churn target created using business rules rather than actual churn data\n2. **Feature Availability**: Some features like PRC_FULL_PAYMENT were not available in the dataset\n3. **Temporal Aspect**: No time-series data to capture actual churn patterns over time\n4. **Domain Expertise**: Risk scoring weights based on business assumptions rather than empirical validation\n\n## Future Work\n\n1. **Real Churn Data**: Collect actual churn events to validate the synthetic target approach\n2. **Time-Series Analysis**: Incorporate temporal patterns in customer behavior\n3. **A/B Testing**: Validate retention strategies through controlled experiments\n4. **Model Deployment**: Implement the model in production with real-time scoring\n5. **Feature Engineering**: Explore additional behavioral and transactional features\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}